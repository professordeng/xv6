---
title: debug
---

## 准备工作

首先要安装 `gdb` 调试工具

```shell
sudo apt-get install gdb
```

`xv6` 已经帮我们写好了 `gdb` 启动脚本，我们在用户目录下添加一个加 `.gdbinit` 的文件，添加 `set auto-load safe-path /` 进去保存即可。

## 调试

进入 `xv6` 目录下执行

```shell
make qemu-nox-gdb
```

另一个终端相同目录下运行 `gdb kernel -silent` 自动连接，开始调试。

```shell
break swtch  # 断点
continue
step         # 直到 return 再到 holding(lk)
continue
clear        # 清除断点
break exec
continue
continue
continue
```

进入阻塞，`qemu` 端输入 `ls -l`。接着下面指令

```bash
print argv[0]
print argv[1]
print argv[2]
backtrace
up
list 
quit
ls -l
```

然后按 `ctrl+a`，再按 c，再按 q 退出。 

